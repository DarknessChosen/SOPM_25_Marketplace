<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Osaka Continental</title>
  <link rel="stylesheet" href="login.css" />
  <link rel="icon" href="./Assets/osaka-continental-logo.svg" type="image/svg+xml">
</head>
<body>
  <div class="login-card">
    <div class="sigil">Osaka Continental</div>
    <h2>The Shadow's Dojo</h2>
    <h3>Your ID, please</h3>

    <form class="login-form" id="loginForm" novalidate>
      <input id="username" type="text" placeholder="Nickname" name="username" required />
      <input id="password" type="password" placeholder="Access key" name="password" required />
      <a id="turnBackLink" href="https://www.google.com" rel="noopener noreferrer">
        Not one of us? You might want to turn back
      </a>
      <button type="submit">This way, warrior</button>
    </form>
  </div>

  <!-- Modal #1: Access denied -->
  <div class="modal" id="ejectModal" aria-hidden="true" role="dialog" aria-labelledby="modalTitle">
    <div class="modal-card">
      <h4 id="modalTitle">You don't belong here.</h4>
      <p>Leave now and forget what you saw.</p>
      <button id="ejectBtn" type="button" class="btn-omen">Exit the premises</button>
    </div>
  </div>

  <!-- Modal #2: Choice Traveller (pentru linkul “turn back”) -->
  <div class="modal" id="turnBackModal" aria-hidden="true" role="dialog" aria-labelledby="turnBackTitle">
    <div class="modal-card alt">
      <h4 id="turnBackTitle">That was a wise choice, traveller.</h4>
      <p id="turnBackText">
        The Osaka Continental ways are not for the uninitiated.
        Let the neon winds guide you back to safer roads.
      </p>
      <button id="guideBtn" type="button" class="btn-guide">
        Take the path back to the light
      </button>
    </div>
  </div>

  <script>
    (function () {
      const ACCESS_CODE = "42069"; // demo: în producție verifici server-side

      const form = document.getElementById("loginForm");
      const password = document.getElementById("password");

      // Modal #1 – access denied
      const ejectModal = document.getElementById("ejectModal");
      const ejectBtn   = document.getElementById("ejectBtn");

      // Modal #2 – choice traveller
      const turnBackModal = document.getElementById("turnBackModal");
      const guideBtn      = document.getElementById("guideBtn");

      // Linkul “turn back”
      const turnBackLink  = document.getElementById("turnBackLink");

      // Helpers generice pentru modale (parametrizate)
      function openModal(el) {
        el.classList.add("active");
        el.setAttribute("aria-hidden", "false");
      }
      function closeModal(el) {
        el.classList.remove("active");
        el.setAttribute("aria-hidden", "true");
      }

      // Eject: redirect definitiv + încercare de închidere (poate fi blocată)
      function ejectToGoogle() {
        window.location.replace("https://www.google.com");
        setTimeout(() => {
          try { window.open('', '_self'); window.close(); } catch (_) {}
        }, 150);
      }

      // Submit login
      form.addEventListener("submit", (ev) => {
        ev.preventDefault();
        if (password.value === ACCESS_CODE) {
          // din Login/ spre Main
          window.location.href = "../Main/main.html";
        } else {
          openModal(ejectModal);
        }
      });

      // Link "Not one of us?" -> deschide modalul #2 cu mesaj tematic
      turnBackLink.addEventListener("click", (ev) => {
        ev.preventDefault(); // cu JS activ, nu mai mergem direct pe href
        openModal(turnBackModal);
      });

      // Butoanele din modale -> ghidare către Google
      guideBtn.addEventListener("click", ejectToGoogle);
      ejectBtn.addEventListener("click", ejectToGoogle);

      // Închidere când faci click pe overlay (ambele modale)
      [ejectModal, turnBackModal].forEach((modal) => {
        modal.addEventListener("click", (e) => {
          if (e.target === modal) closeModal(modal);
        });
      });

      // Escape închide orice modal activ
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          [ejectModal, turnBackModal].forEach((m) => {
            if (m.classList.contains("active")) closeModal(m);
          });
        }
      });
    })();
  </script>
</body>
</html>
